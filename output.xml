<?xml version="1.0" encoding="UTF-8"?>
<robot generator="Robot 7.3.2 (Python 3.13.3 on win32)" generated="2025-10-10T23:13:18.059854" rpa="false" schemaversion="5">
<suite id="s1" name="Patient Api Tests" source="C:\Users\marie\OneDrive\Documents\GitHub\sharerapy\tests\robot\patients\patient_api_tests.robot">
<kw name="Setup Test Environment" owner="common" type="SETUP">
<kw name="Run Keyword If" owner="BuiltIn">
<kw name="Log" owner="BuiltIn">
<msg time="2025-10-10T23:13:18.427447" level="WARN">Warning: Using default test configuration - some tests may be skipped</msg>
<arg>Warning: Using default test configuration - some tests may be skipped</arg>
<arg>WARN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-10-10T23:13:18.427321" elapsed="0.000437"/>
</kw>
<arg>'${SUPABASE_URL}' == 'http://localhost:54321'</arg>
<arg>Log</arg>
<arg>Warning: Using default test configuration - some tests may be skipped</arg>
<arg>WARN</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" start="2025-10-10T23:13:18.427071" elapsed="0.000774"/>
</kw>
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="Check API Server Availability" owner="common">
<kw name="Run Keyword And Return Status" owner="BuiltIn">
<kw name="GET" owner="RequestsLibrary">
<msg time="2025-10-10T23:13:22.504533" level="FAIL">ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/health (Caused by NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x0000023092632CF0&gt;: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))</msg>
<arg>${BASE_URL}/health</arg>
<arg>expected_status=any</arg>
<arg>timeout=5</arg>
<doc>Sends a GET request.</doc>
<status status="FAIL" start="2025-10-10T23:13:18.428357" elapsed="4.093860">ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/health (Caused by NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x0000023092632CF0&gt;: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))</status>
</kw>
<msg time="2025-10-10T23:13:22.522644" level="INFO">${response} = False</msg>
<var>${response}</var>
<arg>GET</arg>
<arg>${BASE_URL}/health</arg>
<arg>expected_status=any</arg>
<arg>timeout=5</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-10-10T23:13:18.428266" elapsed="4.094445"/>
</kw>
<return>
<value>${response}</value>
<status status="PASS" start="2025-10-10T23:13:22.522857" elapsed="0.000124"/>
</return>
<doc>Check if the API server is running and accessible</doc>
<status status="PASS" start="2025-10-10T23:13:18.428125" elapsed="4.095135"/>
</kw>
<msg time="2025-10-10T23:13:22.523448" level="INFO">${api_available} = True</msg>
<var>${api_available}</var>
<arg>Check API Server Availability</arg>
<doc>Runs the given keyword with given arguments and returns the status as a Boolean value.</doc>
<status status="PASS" start="2025-10-10T23:13:18.427958" elapsed="4.095542"/>
</kw>
<kw name="Set Suite Variable" owner="BuiltIn">
<msg time="2025-10-10T23:13:22.524263" level="INFO">${API_AVAILABLE} = True</msg>
<arg>${API_AVAILABLE}</arg>
<arg>${api_available}</arg>
<doc>Makes a variable available everywhere within the scope of the current suite.</doc>
<status status="PASS" start="2025-10-10T23:13:22.523805" elapsed="0.000585"/>
</kw>
<kw name="Run Keyword If" owner="BuiltIn">
<kw name="Create API Session" owner="common">
<kw name="Create Dictionary" owner="BuiltIn">
<msg time="2025-10-10T23:13:22.526163" level="INFO">&amp;{headers} = { apikey=test-anon-key | Authorization=Bearer test-anon-key }</msg>
<var>&amp;{headers}</var>
<arg>apikey=${SUPABASE_ANON_KEY}</arg>
<arg>Authorization=Bearer ${SUPABASE_ANON_KEY}</arg>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<status status="PASS" start="2025-10-10T23:13:22.525505" elapsed="0.000721"/>
</kw>
<kw name="Create Session" owner="RequestsLibrary">
<msg time="2025-10-10T23:13:22.527076" level="INFO">Creating Session using : alias=api, url=http://localhost:3000/api, headers={'apikey': 'test-anon-key', 'Authorization': 'Bearer test-anon-key'},                     cookies={}, auth=None, timeout=None, proxies=None, verify=False,                     debug=0 </msg>
<arg>api</arg>
<arg>${BASE_URL}</arg>
<arg>headers=${headers}</arg>
<arg>verify=${False}</arg>
<doc>Create Session: create a HTTP session to a server</doc>
<status status="PASS" start="2025-10-10T23:13:22.526496" elapsed="0.000976"/>
</kw>
<doc>Create API session with Supabase headers for authentication</doc>
<status status="PASS" start="2025-10-10T23:13:22.525136" elapsed="0.002513"/>
</kw>
<arg>${API_AVAILABLE}</arg>
<arg>Create API Session</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" start="2025-10-10T23:13:22.524652" elapsed="0.003085"/>
</kw>
<kw name="Run Keyword If" owner="BuiltIn">
<arg>not ${API_AVAILABLE}</arg>
<arg>Log</arg>
<arg>Warning: API server not available at ${BASE_URL} - API tests will be skipped</arg>
<arg>WARN</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" start="2025-10-10T23:13:22.527985" elapsed="0.000440"/>
</kw>
<doc>Initialize test environment and API session</doc>
<status status="PASS" start="2025-10-10T23:13:18.426599" elapsed="4.101975"/>
</kw>
<test id="s1-t1" name="Test Read Single Patient Success" line="12">
<kw name="Setup Test Data" owner="common" type="SETUP">
<kw name="Generate Random UUID" owner="common">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-10-10T23:13:22.537126" level="INFO">${uuid} = d69c2806-156d-470d-abd6-d1c16a4bf542</msg>
<var>${uuid}</var>
<arg>str(__import__('uuid').uuid4())</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-10-10T23:13:22.531405" elapsed="0.005801"/>
</kw>
<return>
<value>${uuid}</value>
<status status="PASS" start="2025-10-10T23:13:22.537366" elapsed="0.000113"/>
</return>
<msg time="2025-10-10T23:13:22.537812" level="INFO">${test_uuid} = d69c2806-156d-470d-abd6-d1c16a4bf542</msg>
<var>${test_uuid}</var>
<doc>Generate a random UUID for testing</doc>
<status status="PASS" start="2025-10-10T23:13:22.530945" elapsed="0.006924"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-10-10T23:13:22.538575" level="INFO">${TEST_UUID} = d69c2806-156d-470d-abd6-d1c16a4bf542</msg>
<arg>${TEST_UUID}</arg>
<arg>${test_uuid}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-10-10T23:13:22.538199" elapsed="0.000449"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-10-10T23:13:22.540599" level="INFO">${PATIENT_ID} = </msg>
<arg>${PATIENT_ID}</arg>
<arg>${EMPTY}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-10-10T23:13:22.538858" elapsed="0.001836"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-10-10T23:13:22.542405" level="INFO">${THERAPIST_ID} = </msg>
<arg>${THERAPIST_ID}</arg>
<arg>${EMPTY}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-10-10T23:13:22.540902" elapsed="0.001585"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-10-10T23:13:22.544912" level="INFO">${REPORT_ID} = </msg>
<arg>${REPORT_ID}</arg>
<arg>${EMPTY}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-10-10T23:13:22.542698" elapsed="0.002325"/>
</kw>
<doc>Create clean test data for each test</doc>
<status status="PASS" start="2025-10-10T23:13:22.530303" elapsed="0.014871"/>
</kw>
<kw name="Skip If API Not Available" owner="common">
<kw name="Skip If" owner="BuiltIn">
<arg>not ${API_AVAILABLE}</arg>
<arg>API server not available - skipping test</arg>
<doc>Skips the rest of the current test if the ``condition`` is True.</doc>
<status status="PASS" start="2025-10-10T23:13:22.547731" elapsed="0.000489"/>
</kw>
<doc>Skip test if API server is not available</doc>
<status status="PASS" start="2025-10-10T23:13:22.546165" elapsed="0.002181"/>
</kw>
<kw name="Create Dictionary" owner="BuiltIn">
<msg time="2025-10-10T23:13:22.549386" level="INFO">${patient_data} = {'first_name': 'TestPatient', 'last_name': 'Integration', 'birthdate': '1990-01-01', 'sex': 'male', 'contact_number': '+1234567890', 'country_id': '1'}</msg>
<var>${patient_data}</var>
<arg>&amp;{PATIENT_TEMPLATE}</arg>
<doc>Creates and returns a dictionary based on the given ``items``.</doc>
<status status="PASS" start="2025-10-10T23:13:22.548809" elapsed="0.000628"/>
</kw>
<kw name="Create Test Patient" owner="test_data">
<kw name="POST On Session" owner="RequestsLibrary">
<msg time="2025-10-10T23:13:26.592148" level="WARN">Retrying (RetryAdapter(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x00000230925B3250&gt;: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /api/patients</msg>
<msg time="2025-10-10T23:13:30.836262" level="WARN">Retrying (RetryAdapter(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x00000230925B3390&gt;: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /api/patients</msg>
<msg time="2025-10-10T23:13:35.289878" level="WARN">Retrying (RetryAdapter(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x000002309266B5C0&gt;: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /api/patients</msg>
<msg time="2025-10-10T23:13:39.333861" level="FAIL">ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/patients (Caused by NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x000002309266A520&gt;: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))</msg>
<var>${response}</var>
<arg>api</arg>
<arg>/patients</arg>
<arg>json=${patient_data}</arg>
<doc>Sends a POST request on a previously created HTTP Session.</doc>
<status status="FAIL" start="2025-10-10T23:13:22.550722" elapsed="16.789904">ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/patients (Caused by NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x000002309266A520&gt;: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))</status>
</kw>
<kw name="Should Be Equal As Numbers" owner="BuiltIn">
<arg>${response.status_code}</arg>
<arg>201</arg>
<doc>Fails if objects are unequal after converting them to real numbers.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.340862" elapsed="0.000079"/>
</kw>
<return>
<value>${response.json()}[id]</value>
<status status="NOT RUN" start="2025-10-10T23:13:39.341047" elapsed="0.000038"/>
</return>
<var>${patient_id}</var>
<arg>${patient_data}</arg>
<doc>Helper to create a test patient</doc>
<status status="FAIL" start="2025-10-10T23:13:22.550053" elapsed="16.791310">ConnectionError: HTTPConnectionPool(host='localhost', port=3000): Max retries exceeded with url: /api/patients (Caused by NewConnectionError('&lt;urllib3.connection.HTTPConnection object at 0x000002309266A520&gt;: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))</status>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${PATIENT_ID}</arg>
<arg>${patient_id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.342188" elapsed="0.000068"/>
</kw>
<kw name="GET On Session" owner="RequestsLibrary">
<var>${response}</var>
<arg>api</arg>
<arg>/patients/${patient_id}</arg>
<doc>Sends a GET request on a previously created HTTP Session.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.342949" elapsed="0.000059"/>
</kw>
<kw name="Should Be Equal As Numbers" owner="BuiltIn">
<arg>${response.status_code}</arg>
<arg>200</arg>
<doc>Fails if objects are unequal after converting them to real numbers.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.343725" elapsed="0.000060"/>
</kw>
<kw name="Set Variable" owner="BuiltIn">
<var>${patient}</var>
<arg>${response.json()}</arg>
<doc>Returns the given values which can then be assigned to a variables.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.344470" elapsed="0.000060"/>
</kw>
<kw name="Should Be Equal" owner="BuiltIn">
<arg>${patient}[id]</arg>
<arg>${patient_id}</arg>
<doc>Fails if the given objects are unequal.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.345154" elapsed="0.000061"/>
</kw>
<kw name="Should Be Equal" owner="BuiltIn">
<arg>${patient}[first_name]</arg>
<arg>${patient_data}[first_name]</arg>
<doc>Fails if the given objects are unequal.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.345893" elapsed="0.000027"/>
</kw>
<kw name="Should Be Equal" owner="BuiltIn">
<arg>${patient}[last_name]</arg>
<arg>${patient_data}[last_name]</arg>
<doc>Fails if the given objects are unequal.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.346126" elapsed="0.000023"/>
</kw>
<kw name="Should Contain" owner="BuiltIn">
<arg>${patient}</arg>
<arg>name</arg>
<doc>Fails if ``container`` does not contain ``item`` one or more times.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.346467" elapsed="0.000023"/>
</kw>
<kw name="Should Be Equal" owner="BuiltIn">
<arg>${patient}[name]</arg>
<arg>${patient_data}[first_name] ${patient_data}[last_name]</arg>
<doc>Fails if the given objects are unequal.</doc>
<status status="NOT RUN" start="2025-10-10T23:13:39.347163" elapsed="0.000023"/>
</kw>
<kw name="Cleanup Test Data" owner="common" type="TEARDOWN">
<kw name="Run Keyword And Ignore Error" owner="BuiltIn">
<kw name="Delete Test Patient" owner="test_data">
<kw name="Run Keyword If" owner="BuiltIn">
<arg>'${patient_id}' != '${EMPTY}'</arg>
<arg>DELETE On Session</arg>
<arg>api</arg>
<arg>/patients/${patient_id}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" start="2025-10-10T23:13:39.349363" elapsed="0.000505"/>
</kw>
<arg>${PATIENT_ID}</arg>
<doc>Helper to delete a test patient</doc>
<status status="PASS" start="2025-10-10T23:13:39.348266" elapsed="0.001663"/>
</kw>
<arg>Delete Test Patient</arg>
<arg>${PATIENT_ID}</arg>
<doc>Runs the given keyword with the given arguments and ignores possible error.</doc>
<status status="PASS" start="2025-10-10T23:13:39.347913" elapsed="0.002048"/>
</kw>
<kw name="Run Keyword And Ignore Error" owner="BuiltIn">
<kw name="Delete Test Therapist" owner="test_data">
<kw name="Run Keyword If" owner="BuiltIn">
<arg>'${therapist_id}' != '${EMPTY}'</arg>
<arg>DELETE On Session</arg>
<arg>api</arg>
<arg>/therapists/${therapist_id}</arg>
<doc>Runs the given keyword with the given arguments, if ``condition`` is true.</doc>
<status status="PASS" start="2025-10-10T23:13:39.350404" elapsed="0.000337"/>
</kw>
<arg>${THERAPIST_ID}</arg>
<doc>Helper to delete a test therapist